# kallisto_to_DGE(): read in Kallisto abundance.h5 output file,
# return DGEList of counts
# Three inputs
# Name of folder containing abundance.h5 output file
# Absolute path to folder containing kallisto output folders
# Absolute path to blast results with transcript ID and gene ID
kallisto_to_txi <- function(folder, output_path, blast_path) {
# Import BLAST results
gene_matches_raw <- read_tsv(file = blast_path,
col_names = FALSE)
# Select only first two columns of BLAST results - transcript and gene IDs
gene_matches <- gene_matches_raw[,1:2]
# Define full absolute path to abundance.h5 output file
kallistopath <- paste(output_path, folder, "/abundance.h5", sep = "")
# Import abundance.h5 file using tximport, creating a list of abundance/counts/length/countsfromabundance
# txOut = TRUE gives transcript-level summarization.
# Get gene-level summarization by setting txOut = FALSE
imported <- tximport(files = kallistopath, type = "kallisto",
txOut = TRUE,
tx2gene = gene_matches)
return(imported)
}
# Define absolute path to the folder containing your Kallisto outputs
output_location <- "C:/Users/acoyl/Documents/GitHub/hemat_bairdii_transcriptome/output/kallisto_output_transcriptome_3.0/"
# Define absolute path to BLAST results
blast_location <- "C:/Users/acoyl/Documents/GitHub/hemat_bairdii_transcriptome/data/cbai_hemat_diamond_blastx_table_transcriptome_v3.0.txt"
library_02.txi <- kallisto_to_txi(folder = "library02", output_path = output_location, blast_path = blast_location)
#### Loading Packages ---------------------------------
library(BiocManager)
library(edgeR)
library(rhdf5)
library(tximport)
library(tidyverse)
library(csaw)
setwd("C:/Users/acoyl/Documents/GitHub/hemat_bairdii_transcriptome/output/kallisto_output_transcriptome_v3.0")
test <- read_tsv(file = "kallisto.isoform.counts.matrix", col.names = TRUE)
?read_tsv
gene_matches <- read_tsv(file = "C:Users/acoyl/Documents/GitHub/hemat_bairdii_transcriptome/data/cbai_hemat_diamond_blastx_table_transcriptome_v3.0.txt",
col_names = FALSE)
gene_matches <- read_tsv(file = "C:/Users/acoyl/Documents/GitHub/hemat_bairdii_transcriptome/data/cbai_hemat_diamond_blastx_table_transcriptome_v3.0.txt",
col_names = FALSE)
gene_matches <- gene_matches[,1:2]
View(gene_matches)
test <- tximport(files = "kallisto.isoform.counts.matrix", type = "kallisto", txOut = TRUE, tx2gene = gene_matches)
