---
title: "Gene Enrichment with GO-MWU"
author: "Aidan Coyle"
date: "1/31/2021"
output: html_document
---

This document is heavily based off of a script made by Yaamini Venkataraman, available [here](https://github.com/epigeneticstoocean/paper-gonad-meth/blob/master/code/14-Gene-Enrichment-with-GO-MWU.Rmd)

## Basics of GO-MWU

[GO-MWU](https://github.com/z0on/GO_MWU) analyzes gene enrichment

Running GO-MWU requires 2 tables
1. A 2-column CSV table of gene IDs and continuous measures assc. with GO enrichment (here, using unadjusted p-val)

2. A 2-column tab-delimited table of gene IDs and GO terms separated by ;

# Set up R Markdown file

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Install packages

```{r}
require(dichromat)
```

# Create master list

## Import 2-col table of accession IDs and p-values

```{r}
geneBackground <- read.csv("../output/input_for_GO-MWU/Amb_vsLow_day02.csv")

# Rename columns
colnames(geneBackground) <- c("Uniprot", "pvalue")

# Confirm import
head(geneBackground)
```

## Import 2-col table of gene IDs and GO terms

```{r}
uniprotGOTerms <- read.delim("../output/input_for_GO-MWU/Amb_vsLow_All_GOIDs.txt",
                             header = FALSE)

# Rename columns
colnames(uniprotGOTerms) <- c("Uniprot", "GO")

#Confirm import
head(uniprotGOTerms)
```

## Merge gene background with GO terms

```{r}
geneBackgroundGOterms <- merge(x = geneBackground,
                               y = uniprotGOTerms,
                               by = "Uniprot")
head(geneBackgroundGOterms)

```


## Merge gene background with 