# Drop any genes with less than 5 counts across all 3 samples
keep <- rowSums(crabdat) >= 5
f.crabdat <- crabdat[keep, ]
print(paste("# of genes remaining after pre-filtering:", nrow(f.crabdat)))
print(paste("# of genes dropped:", nrow(crabdat) - nrow(f.crabdat), sep = " "))
pheatmap(f.crabdat, cluster_rows = TRUE,
show_rownames = FALSE,
na.rm = TRUE,
cluster_cols = FALSE,
scale = "row",
main = "gene counts by day",
fontsize = 9)
print(pheatmap(clust, cluster_rows = TRUE,
show_rownames = FALSE,
na.rm = TRUE,
cluster_cols = FALSE,
scale = "row",
main = paste0("gene counts by day, cluster ", i),
fontsize = 9))
pheatmap(f.crabdat, cluster_rows = TRUE,
show_rownames = FALSE,
na.rm = TRUE,
cluster_cols = FALSE,
scale = "row",
main = "gene counts by day",
fontsize = 9)
png(paste0(crab_out, "heatmap.png"))
pheatmap(f.crabdat, cluster_rows = TRUE,
show_rownames = FALSE,
na.rm = TRUE,
cluster_cols = FALSE,
scale = "row",
main = "gene counts by day",
fontsize = 9)
dev.off()
crab_out
png(paste0(crab_out, "heatmap.png"))
pheatmap(f.crabdat, cluster_rows = TRUE,
show_rownames = FALSE,
na.rm = TRUE,
cluster_cols = FALSE,
scale = "row",
main = "gene counts by day",
fontsize = 9)
dev.off()
# SPECIFY NUMBER OF CLUSTERS
clusters <- 3
# Extract gene clusters
out <- pheatmap(f.crabdat, cluster_rows = TRUE,
show_rownames = FALSE,
na.rm = TRUE,
cluster_cols = FALSE,
scale = "row",
main = "gene counts by day",
fontsize = 9)
hc <- out$tree_row
lbl <- cutree(hc, clusters) # split dendrogram into the number of groups specified above
# Loop through gene clusters, printing heatmap for each
for (i in 1:clusters) {
clust <- f.crabdat[which(lbl==i) %>% names(), ]
# Write results to table
write.table(clust, file = paste0(crab_out,
"cluster_",
i, ".txt"),
sep = "\t",
row.names = TRUE)
# Create heat map for each cluster
png(paste0(crab_out, "cluster_", i, "_heatmap.png"))
print(pheatmap(clust, cluster_rows = TRUE,
show_rownames = FALSE,
na.rm = TRUE,
cluster_cols = FALSE,
scale = "row",
main = paste0("gene counts by day, cluster ", i),
fontsize = 9))
dev.off()
}
# Set path to output folder that will contain all heatmaps and text files for Crab B
crab_out <- paste0(heatmap_output, "Crab_B/")
# Read in data
crabdat <- read.delim(file = paste0(TPM_outpath,
"Crab_",
crabs[2],
"_TPMcts.txt"),
row.names = 1)
# Drop any genes with less than 5 counts across all 3 samples
keep <- rowSums(crabdat) >= 5
f.crabdat <- crabdat[keep, ]
print(paste("# of genes remaining after pre-filtering:", nrow(f.crabdat)))
print(paste("# of genes dropped:", nrow(crabdat) - nrow(f.crabdat), sep = " "))
pheatmap(f.crabdat, cluster_rows = TRUE,
show_rownames = FALSE,
na.rm = TRUE,
cluster_cols = FALSE,
scale = "row",
main = "gene counts by day",
fontsize = 9)
png(paste0(crab_out, "heatmap.png"))
pheatmap(f.crabdat, cluster_rows = TRUE,
show_rownames = FALSE,
na.rm = TRUE,
cluster_cols = FALSE,
scale = "row",
main = "gene counts by day",
fontsize = 9)
dev.off()
png(paste0(crab_out, "heatmap.png"))
pheatmap(f.crabdat, cluster_rows = TRUE,
show_rownames = FALSE,
na.rm = TRUE,
cluster_cols = FALSE,
scale = "row",
main = "gene counts by day",
fontsize = 9)
dev.off()
# SPECIFY NUMBER OF CLUSTERS
clusters <- 5
# Extract gene clusters
out <- pheatmap(f.crabdat, cluster_rows = TRUE,
show_rownames = FALSE,
na.rm = TRUE,
cluster_cols = FALSE,
scale = "row",
main = "gene counts by day",
fontsize = 9)
hc <- out$tree_row
lbl <- cutree(hc, clusters) # split dendrogram into the number of groups specified above
# Loop through gene clusters, printing heatmap for each
for (i in 1:clusters) {
clust <- f.crabdat[which(lbl==i) %>% names(), ]
# Write results to table
write.table(clust, file = paste0(crab_out,
"cluster_",
i, ".txt"),
sep = "\t",
row.names = TRUE)
# Create heat map for each cluster
png(paste0(crab_out, "cluster_", i, "_heatmap.png"))
print(pheatmap(clust, cluster_rows = TRUE,
show_rownames = FALSE,
na.rm = TRUE,
cluster_cols = FALSE,
scale = "row",
main = paste0("gene counts by day, cluster ", i),
fontsize = 9))
dev.off()
}
# Set path to output folder that will contain all heatmaps and text files for Crab C
crab_out <- paste0(heatmap_output, "Crab_C/")
# Read in data
crabdat <- read.delim(file = paste0(TPM_outpath,
"Crab_",
crabs[3],
"_TPMcts.txt"),
row.names = 1)
# Drop any genes with less than 5 counts across all 3 samples
keep <- rowSums(crabdat) >= 5
f.crabdat <- crabdat[keep, ]
print(paste("# of genes remaining after pre-filtering:", nrow(f.crabdat)))
print(paste("# of genes dropped:", nrow(crabdat) - nrow(f.crabdat), sep = " "))
pheatmap(f.crabdat, cluster_rows = TRUE,
show_rownames = FALSE,
na.rm = TRUE,
cluster_cols = FALSE,
scale = "row",
main = "gene counts by day",
fontsize = 9)
png(paste0(crab_out, "heatmap.png"))
pheatmap(f.crabdat, cluster_rows = TRUE,
show_rownames = FALSE,
na.rm = TRUE,
cluster_cols = FALSE,
scale = "row",
main = "gene counts by day",
fontsize = 9)
dev.off()
png(paste0(crab_out, "heatmap.png"))
pheatmap(f.crabdat, cluster_rows = TRUE,
show_rownames = FALSE,
na.rm = TRUE,
cluster_cols = FALSE,
scale = "row",
main = "gene counts by day",
fontsize = 9)
dev.off()
pheatmap(f.crabdat, cluster_rows = TRUE,
show_rownames = FALSE,
na.rm = TRUE,
cluster_cols = FALSE,
scale = "row",
main = "gene counts by day",
fontsize = 9)
# SPECIFY NUMBER OF CLUSTERS
clusters <- 8
# Extract gene clusters
out <- pheatmap(f.crabdat, cluster_rows = TRUE,
show_rownames = FALSE,
na.rm = TRUE,
cluster_cols = FALSE,
scale = "row",
main = "gene counts by day",
fontsize = 9)
hc <- out$tree_row
lbl <- cutree(hc, clusters) # split dendrogram into the number of groups specified above
# Loop through gene clusters, printing heatmap for each
for (i in 1:clusters) {
clust <- f.crabdat[which(lbl==i) %>% names(), ]
# Write results to table
write.table(clust, file = paste0(crab_out,
"cluster_",
i, ".txt"),
sep = "\t",
row.names = TRUE)
# Create heat map for each cluster
png(paste0(crab_out, "cluster_", i, "_heatmap.png"))
print(pheatmap(clust, cluster_rows = TRUE,
show_rownames = FALSE,
na.rm = TRUE,
cluster_cols = FALSE,
scale = "row",
main = paste0("gene counts by day, cluster ", i),
fontsize = 9))
dev.off()
}
# Set path to output folder that will contain all heatmaps and text files for Crab E
crab_out <- paste0(heatmap_output, "Crab_E/")
# Read in data
crabdat <- read.delim(file = paste0(TPM_outpath,
"Crab_",
crabs[4],
"_TPMcts.txt"),
row.names = 1)
# Drop any genes with less than 5 counts across all 3 samples
keep <- rowSums(crabdat) >= 5
f.crabdat <- crabdat[keep, ]
print(paste("# of genes remaining after pre-filtering:", nrow(f.crabdat)))
print(paste("# of genes dropped:", nrow(crabdat) - nrow(f.crabdat), sep = " "))
# Construct heat map
pheatmap(f.crabdat, cluster_rows = TRUE,
show_rownames = FALSE,
na.rm = TRUE,
cluster_cols = FALSE,
scale = "row",
main = "gene counts by day",
fontsize = 9)
pheatmap(f.crabdat, cluster_rows = TRUE,
show_rownames = FALSE,
na.rm = TRUE,
cluster_cols = FALSE,
scale = "row",
main = "gene counts by day",
fontsize = 9)
png(paste0(crab_out, "heatmap.png"))
pheatmap(f.crabdat, cluster_rows = TRUE,
show_rownames = FALSE,
na.rm = TRUE,
cluster_cols = FALSE,
scale = "row",
main = "gene counts by day",
fontsize = 9)
dev.off()
png(paste0(crab_out, "heatmap.png"))
pheatmap(f.crabdat, cluster_rows = TRUE,
show_rownames = FALSE,
na.rm = TRUE,
cluster_cols = FALSE,
scale = "row",
main = "gene counts by day",
fontsize = 9)
dev.off()
# SPECIFY NUMBER OF CLUSTERS
clusters <- 6
# Extract gene clusters
out <- pheatmap(f.crabdat, cluster_rows = TRUE,
show_rownames = FALSE,
na.rm = TRUE,
cluster_cols = FALSE,
scale = "row",
main = "gene counts by day",
fontsize = 9)
hc <- out$tree_row
lbl <- cutree(hc, clusters) # split dendrogram into the number of groups specified above
# Loop through gene clusters, printing heatmap for each
for (i in 1:clusters) {
clust <- f.crabdat[which(lbl==i) %>% names(), ]
# Write results to table
write.table(clust, file = paste0(crab_out,
"cluster_",
i, ".txt"),
sep = "\t",
row.names = TRUE)
# Create heat map for each cluster
png(paste0(crab_out, "cluster_", i, "_heatmap.png"))
print(pheatmap(clust, cluster_rows = TRUE,
show_rownames = FALSE,
na.rm = TRUE,
cluster_cols = FALSE,
scale = "row",
main = paste0("gene counts by day, cluster ", i),
fontsize = 9))
dev.off()
}
# Set path to output folder that will contain all heatmaps and text files for Crab G
crab_out <- paste0(heatmap_output, "Crab_G/")
# Read in data
crabdat <- read.delim(file = paste0(TPM_outpath,
"Crab_",
crabs[5],
"_TPMcts.txt"),
row.names = 1)
# Drop any genes with less than 5 counts across all 3 samples
keep <- rowSums(crabdat) >= 5
f.crabdat <- crabdat[keep, ]
print(paste("# of genes remaining after pre-filtering:", nrow(f.crabdat)))
print(paste("# of genes dropped:", nrow(crabdat) - nrow(f.crabdat), sep = " "))
pheatmap(f.crabdat, cluster_rows = TRUE,
show_rownames = FALSE,
na.rm = TRUE,
cluster_cols = FALSE,
scale = "row",
main = "gene counts by day",
fontsize = 9)
pheatmap(f.crabdat, cluster_rows = TRUE,
show_rownames = FALSE,
na.rm = TRUE,
cluster_cols = FALSE,
scale = "row",
main = "gene counts by day",
fontsize = 9)
as
5+4
getwd()
pheatmap(f.crabdat, cluster_rows = TRUE,
show_rownames = FALSE,
na.rm = TRUE,
cluster_cols = FALSE,
scale = "row",
main = "gene counts by day",
fontsize = 9)
png(paste0(crab_out, "heatmap.png"))
pheatmap(f.crabdat, cluster_rows = TRUE,
show_rownames = FALSE,
na.rm = TRUE,
cluster_cols = FALSE,
scale = "row",
main = "gene counts by day",
fontsize = 9)
dev.off()
png(paste0(crab_out, "heatmap.png"))
pheatmap(f.crabdat, cluster_rows = TRUE,
show_rownames = FALSE,
na.rm = TRUE,
cluster_cols = FALSE,
scale = "row",
main = "gene counts by day",
fontsize = 9)
dev.off()
# SPECIFY NUMBER OF CLUSTERS
clusters <- 2
# Extract gene clusters
out <- pheatmap(f.crabdat, cluster_rows = TRUE,
show_rownames = FALSE,
na.rm = TRUE,
cluster_cols = FALSE,
scale = "row",
main = "gene counts by day",
fontsize = 9)
hc <- out$tree_row
lbl <- cutree(hc, clusters) # split dendrogram into the number of groups specified above
# Loop through gene clusters, printing heatmap for each
for (i in 1:clusters) {
clust <- f.crabdat[which(lbl==i) %>% names(), ]
# Write results to table
write.table(clust, file = paste0(crab_out,
"cluster_",
i, ".txt"),
sep = "\t",
row.names = TRUE)
# Create heat map for each cluster
png(paste0(crab_out, "cluster_", i, "_heatmap.png"))
print(pheatmap(clust, cluster_rows = TRUE,
show_rownames = FALSE,
na.rm = TRUE,
cluster_cols = FALSE,
scale = "row",
main = paste0("gene counts by day, cluster ", i),
fontsize = 9))
dev.off()
}
# Set path to output folder that will contain all heatmaps and text files for Crab H
crab_out <- paste0(heatmap_output, "Crab_H/")
# Read in data
crabdat <- read.delim(file = paste0(TPM_outpath,
"Crab_",
crabs[6],
"_TPMcts.txt"),
row.names = 1)
# Drop any genes with less than 5 counts across all 3 samples
keep <- rowSums(crabdat) >= 5
f.crabdat <- crabdat[keep, ]
print(paste("# of genes remaining after pre-filtering:", nrow(f.crabdat)))
print(paste("# of genes dropped:", nrow(crabdat) - nrow(f.crabdat), sep = " "))
# Construct heat map
pheatmap(f.crabdat, cluster_rows = TRUE,
show_rownames = FALSE,
na.rm = TRUE,
cluster_cols = FALSE,
scale = "row",
main = "gene counts by day",
fontsize = 9)
png(paste0(crab_out, "heatmap.png"))
pheatmap(f.crabdat, cluster_rows = TRUE,
show_rownames = FALSE,
na.rm = TRUE,
cluster_cols = FALSE,
scale = "row",
main = "gene counts by day",
fontsize = 9)
dev.off()
# SPECIFY NUMBER OF CLUSTERS
clusters <- 2
# Extract gene clusters
out <- pheatmap(f.crabdat, cluster_rows = TRUE,
show_rownames = FALSE,
na.rm = TRUE,
cluster_cols = FALSE,
scale = "row",
main = "gene counts by day",
fontsize = 9)
hc <- out$tree_row
lbl <- cutree(hc, clusters) # split dendrogram into the number of groups specified above
# Loop through gene clusters, printing heatmap for each
for (i in 1:clusters) {
clust <- f.crabdat[which(lbl==i) %>% names(), ]
# Write results to table
write.table(clust, file = paste0(crab_out,
"cluster_",
i, ".txt"),
sep = "\t",
row.names = TRUE)
# Create heat map for each cluster
png(paste0(crab_out, "cluster_", i, "_heatmap.png"))
print(pheatmap(clust, cluster_rows = TRUE,
show_rownames = FALSE,
na.rm = TRUE,
cluster_cols = FALSE,
scale = "row",
main = paste0("gene counts by day, cluster ", i),
fontsize = 9))
dev.off()
}
# Set path to output folder that will contain all heatmaps and text files for Crab I
crab_out <- paste0(heatmap_output, "Crab_I/")
# Read in data
crabdat <- read.delim(file = paste0(TPM_outpath,
"Crab_",
crabs[7],
"_TPMcts.txt"),
row.names = 1)
# Drop any genes with less than 5 counts across all 3 samples
keep <- rowSums(crabdat) >= 5
f.crabdat <- crabdat[keep, ]
print(paste("# of genes remaining after pre-filtering:", nrow(f.crabdat)))
print(paste("# of genes dropped:", nrow(crabdat) - nrow(f.crabdat), sep = " "))
pheatmap(f.crabdat, cluster_rows = TRUE,
show_rownames = FALSE,
na.rm = TRUE,
cluster_cols = FALSE,
scale = "row",
main = "gene counts by day",
fontsize = 9)
png(paste0(crab_out, "heatmap.png"))
pheatmap(f.crabdat, cluster_rows = TRUE,
show_rownames = FALSE,
na.rm = TRUE,
cluster_cols = FALSE,
scale = "row",
main = "gene counts by day",
fontsize = 9)
dev.off()
# SPECIFY NUMBER OF CLUSTERS
clusters <- 2
# Extract gene clusters
out <- pheatmap(f.crabdat, cluster_rows = TRUE,
show_rownames = FALSE,
na.rm = TRUE,
cluster_cols = FALSE,
scale = "row",
main = "gene counts by day",
fontsize = 9)
hc <- out$tree_row
lbl <- cutree(hc, clusters) # split dendrogram into the number of groups specified above
# Loop through gene clusters, printing heatmap for each
for (i in 1:clusters) {
clust <- f.crabdat[which(lbl==i) %>% names(), ]
# Write results to table
write.table(clust, file = paste0(crab_out,
"cluster_",
i, ".txt"),
sep = "\t",
row.names = TRUE)
# Create heat map for each cluster
png(paste0(crab_out, "cluster_", i, "_heatmap.png"))
print(pheatmap(clust, cluster_rows = TRUE,
show_rownames = FALSE,
na.rm = TRUE,
cluster_cols = FALSE,
scale = "row",
main = paste0("gene counts by day, cluster ", i),
fontsize = 9))
dev.off()
}
