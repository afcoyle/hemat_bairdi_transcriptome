library(DESeq2)
data <- read.table("../output/kallisto_indivlibs_transcriptome_v3.0/day0_day17_matrix/kallisto.isoform.counts.matrix",
header = TRUE, sep = "\t")
View(data)
# Rename first column
names(data)[1] <- "target_ID"
# Set row names equal to the first column
rownames(data) <- data$target_ID
# Remove the now-irrelevant first column
data <- data[,-1]
# Make sure everything looks okay
head(data)
str(data)
# Round counts to integers (needed for DESeqDataSetFromMatrix()
data <- round(data, digits = 0)
# Day and temperature data for libraries
# 118, 132, 178, 463, 481, 485 (in order)
deseq2.colData <- data.frame(day = factor(c(0, 0, 0, 17, 17, 17)),
temp = factor(c("Amb", "Amb", "Amb", "Amb", "Amb", "Amb")))
# Rename rows to correspond to library numbers
rownames(deseq2.colData) <- colnames(data)
View(deseq2.colData)
View(data)
# Rename rows to correspond to library numbers
rownames(deseq2.colData) <- colnames(data)
# Check that it looks alright
deseq2.colData
# Create DESeq object that looks at effect of day
deseq2.dds <- DESeqDataSetFromMatrix(countData = (data),
colData = deseq2.colData,
design = ~ day)
deseq2.dds <- DESeq(deseq2.dds)
#Look at results
deseq2.res <- results(deseq2.dds)
deseq2.res
summary(deseq2.res)
# Shrink LFC estimates - used in some but not all analyses
resultsNames(deseq2.dds)
resLFC <- lfcShrink(deseq2.dds, coef = "day_17_vs_0",
type = "apeglm")
library(apeglm)
library(vsn)
resLFC <- lfcShrink(deseq2.dds, coef = "day_17_vs_0",
type = "apeglm")
resLFC
# Dimensions of non-NA results with an adjusted p-value of <= 0.05
dim(deseq2.res[!is.na(deseq2.res$padj) & deseq2.res$padj <= 0.05, ])
# Sum of non-NA results w/ adjusted p-values less than 0.1
sum(deseq2.res$padj < 0.1, na.rm = TRUE)
# Look specifically at results w/ adjusted p-value < 0.05
deseq_res05 <- results(deseq2.dds, alpha = 0.05)
summary(deseq_res05)
head(deseq_res05)
sum(deseq_res05$padj < 0.05, na.rm = TRUE)
